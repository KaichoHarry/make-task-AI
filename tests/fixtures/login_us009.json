{
    "domain": "Enterprise Workflow System",
    "persona": "Corporate Manager",
    "action": "I want to approve applications (expenses, contracts, discounts, etc.) in stages",
    "reason": "To prevent misprocessing and fraudulent applications, and to maintain internal control",
    "acceptance_criteria": [
        "The approval workflow is only available to authenticated users.",
        "Only roles with application creation authority can register applications.",
        "Only roles with approval authority can execute approval operations.",
        "Application IDs are automatically numbered and unique.",
        "Application types (Expenses/Contracts/Purchase/Special Request, etc.) must be selectable from predefined options.",
        "The applicant's User ID must always be linked to the application.",
        "The application date and time are automatically recorded.",
        "Applications must have a status (Draft/Submitted/Approved/Rejected/Cancelled).",
        "Only applications in 'Draft' status can be edited.",
        "Application content is generally uneditable once transitioned to 'Submitted' (except during return/remand).",
        "Multi-stage approval flows can be configured (e.g., Level 1 -> Level 2 -> Final).",
        "Approval roles or approval groups can be set for each approval stage.",
        "Approval order must follow the sequence (next stage cannot proceed if previous is unapproved).",
        "Approval operations cannot be performed by anyone other than the designated approver.",
        "The approver's ID and approval timestamp are stored at the time of approval.",
        "A reason for rejection (max 300 characters) is mandatory when rejected.",
        "Rejection reasons must be sanitized (Anti-XSS).",
        "Applicants are notified of returns when an application is rejected.",
        "A setting is possible to return the status to 'Draft' after a remand.",
        "Full approval history must be maintained.",
        "Approval history includes 'Stage/Operation Type/Operating User/Timestamp/Comments'.",
        "Application content can support variable fields using a JSON structure, etc.",
        "Transition to 'Submitted' is prohibited if mandatory items are missing.",
        "Numeric format checks are performed for applications involving monetary amounts.",
        "Settings allow for the automatic insertion of additional approval stages if a monetary limit is exceeded.",
        "DB access uses parameterized queries/ORM (Anti-SQL Injection).",
        "Input values must be sanitized (Anti-XSS).",
        "Approval operations must be completed within a DB transaction.",
        "If an exception occurs during approval processing, it must be rolled back.",
        "Concurrent approval conflicts for the same application must be detected (Optimistic Locking).",
        "Approval operations fail if there is a version mismatch.",
        "Event notifications to related systems can be issued upon approval completion.",
        "Notifications are processed via asynchronous queues.",
        "Application and approval operation logs are stored as audit logs.",
        "Audit logs include user_id, operation type, application ID, IP, User-Agent, and timestamp.",
        "Audit logs are stored in tamper-evident storage.",
        "The same validation as the UI applies to operations via API.",
        "The API must be REST-compliant.",
        "API versioning is managed.",
        "Rate limiting is applied to the endpoints.",
        "Appropriate HTTP status codes (400/401/403/404/409/429) are returned for invalid requests.",
        "Internal exception information is not included in error responses.",
        "Response formats are unified as JSON.",
        "Character encoding is unified as UTF-8.",
        "Dates and times are handled in ISO-8601 format.",
        "Time zones follow the system configuration.",
        "The approval list screen only displays data based on user permissions.",
        "Viewing restrictions for applications from other departments can be applied."
    ]
}